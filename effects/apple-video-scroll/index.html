<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>MacPro 视频滚动效果</title>
  <script src="./lib/TweenLite.min.js"></script>
  <style>
    body {
      margin: 0;
      background: #000;
      height: 1500vh;
    }

    #myVideo {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
  </style>
</head>

<body>
<!-- https://www.apple.com/media/us/mac-pro/2013/16C1b6b5-1d91-4fef-891e-ff2fc1c1bb58/videos/macpro_main_desktop.mp4 -->
<video id="myVideo" src="./macpro_main_desktop.mp4"></video>

<script>
  window.onload = function () {
    var video = document.getElementById('myVideo');
    var duration = 0;
    var pageHeight = document.body.scrollHeight - window.innerHeight;

    video.addEventListener('loadedmetadata', function (e) {
      duration = e.target.duration
      console.log('视频元数据已加载', duration)

      document.addEventListener('scroll', handleScrollSimple)
    });

    function handleScroll() {
      var y = window.pageYOffset;
      var currentTime = y / 100;
      var playTo = currentTime;
      duration = Math.sqrt(Math.abs(video.currentTime - currentTime)) / 4;
      TweenLite.to(video, duration, {currentTime: currentTime, ease: Linear.easeInOut});
    }

    function handleScrollSimple(e) {
      var y = window.pageYOffset

      var percent = (y / pageHeight);

      video.currentTime = duration * percent
      console.log(y, percent.toFixed(2) + '%')
    }
  }
</script>
</body>

</html>